syms('q1', 'q2', 'q3', 'theta', 'a', 'l');
phi1 = pi/2 + theta - q1;
phi2 = -q2;
phi3 = pi/2 - theta - q3;
A10 = [cos(phi1) -sin(phi1), 0, a*cos(phi1);
    sin(phi1), cos(phi1), 0, a*sin(phi1);
    0, 0, 1, 0;
    0, 0, 0, 1];
A21 = [cos(phi2) -sin(phi2), 0, a*cos(phi2);
    sin(phi2), cos(phi2), 0, a*sin(phi2);
    0, 0, 1, 0;
    0, 0, 0, 1];
A32 = [cos(phi3) -sin(phi3), 0, l*cos(phi3);
    sin(phi3), cos(phi3), 0, l*sin(phi3);
    0, 0, 1, 0;
    0, 0, 0, 1];
A30 = simplify(A10*A21*A32);
display(A30)
k = [A30(1:2, 4); q3];
display(k);
J = simplify([diff(k, q1), diff(k, q2), diff(k, q3)]);
display(J);
invJ = simplify(inv(J));
display(invJ);
singularity = det(J) == 0;
singularConfigurations = solve(singularity, [q1, q2, q3]);
display(singularConfigurations);
disp("No singular configurations");